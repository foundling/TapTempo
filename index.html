<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf8" />
    </head>
    <body>

        <h1>Times:</h1>
        <div style="width: 400px;" id="times"></div>

        <h1>BPM:</h1>
        <div><span id="bpm"></span> beats per minute</div>

        <script type="text/javascript">

            let taps = [ ];
            const sampleWindow = 2; 

            document.addEventListener('keydown', handleTap);

            function handleTap () {

                if (taps.length < sampleWindow + 1)
                    return taps.push(Date.now());

                let deltaMilliseconds = taps[sampleWindow] - taps[0];
                let deltaSeconds = deltaMilliseconds / 1000;
                let tapsPerMinute = (60 * sampleWindow)/deltaSeconds;

                taps.splice(0, taps.length);

                writeToDOM(document.getElementById('bpm'), Math.floor(tapsPerMinute));

            }

            function writeToDOM(el, bpm) {
                el.innerHTML = bpm;
            }

        </script>
    </body>
</html>

